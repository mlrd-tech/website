<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Part 2: Backfill and Dual-write Data Create empty backfill lock: INSERT INTO mlrd._migration (tableName, flag) VALUES ('...', 'backfill') Start one mlrd in a backfill mode Dump DynamoDB table and load into MySQL but do not overwrite existing items because anything already present in MySQL is from a write DynamoDB is written to first and remains authoritative (the source of truth) MySQL is written to second (as shown in the Write2 column above) Backfill writes are authoritative Items in MySQL are newest: either from a mirror write or a backfill MySQL write error during backfill: OK, just be sure to log and retry/re-backfill the item(s)
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://mlrd.tech/docs/v0-beta/migration/part-2/"><meta property="og:site_name" content="mlrd Docs"><meta property="og:title" content="Part 2: Backfill"><meta property="og:description" content="Part 2: Backfill and Dual-write Data Create empty backfill lock: INSERT INTO mlrd._migration (tableName, flag) VALUES ('...', 'backfill') Start one mlrd in a backfill mode Dump DynamoDB table and load into MySQL but do not overwrite existing items because anything already present in MySQL is from a write DynamoDB is written to first and remains authoritative (the source of truth) MySQL is written to second (as shown in the Write2 column above) Backfill writes are authoritative Items in MySQL are newest: either from a mirror write or a backfill MySQL write error during backfill: OK, just be sure to log and retry/re-backfill the item(s)"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="v0-beta"><meta itemprop=name content="Part 2: Backfill"><meta itemprop=description content="Part 2: Backfill and Dual-write Data Create empty backfill lock: INSERT INTO mlrd._migration (tableName, flag) VALUES ('...', 'backfill') Start one mlrd in a backfill mode Dump DynamoDB table and load into MySQL but do not overwrite existing items because anything already present in MySQL is from a write DynamoDB is written to first and remains authoritative (the source of truth) MySQL is written to second (as shown in the Write2 column above) Backfill writes are authoritative Items in MySQL are newest: either from a mirror write or a backfill MySQL write error during backfill: OK, just be sure to log and retry/re-backfill the item(s)"><meta itemprop=wordCount content="104"><title>Part 2: Backfill | mlrd Docs</title><link rel=icon href=/docs/favicon.png><link rel=manifest href=/docs/manifest.json><link rel=canonical href=https://mlrd.tech/docs/v0-beta/migration/part-2/><link rel=stylesheet href=/docs/book.min.c7c5a7bad7c8651d49384a78f4991de1d9208d263da075dce6bbe494107c31b7.css integrity="sha256-x8WnutfIZR1JOEp49Jkd4dkgjSY9oHXc5rvklBB8Mbc=" crossorigin=anonymous><script defer src=/docs/fuse.min.js></script><script defer src=/docs/en.search.min.69bb41b6fa177e6f858857c10a5ad8581417ba9f0acf512ff1e5f43a84af7783.js integrity="sha256-abtBtvoXfm+FiFfBClrYWBQXup8Kz1Ev8eX0OoSvd4M=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-v0-beta"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/docs/><img src=/docs/img/mlrd-logo-v0.png alt=Logo><span>mlrd Docs</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/docs/v0-beta/>v0-beta</a><ul><li><a href=/docs/v0-beta/quick-start/>Quick Start</a></li><li><a href=/docs/v0-beta/high-level/>High Level</a></li><li><a href=/docs/v0-beta/concepts/>Concepts</a></li><li><input type=checkbox id=section-bba9f648e1c8239acdafe50731378ee0 class=toggle>
<label for=section-bba9f648e1c8239acdafe50731378ee0 class=flex><a role=button>Config</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/v0-beta/config/command-line/>Command Line</a></li><li><a href=/docs/v0-beta/config/feature-flags/>Feature Flags</a></li><li><a href=/docs/v0-beta/config/standard/>Standard</a></li><li><a href=/docs/v0-beta/config/sys/>Sys</a></li><li><a href=/docs/v0-beta/config/table/>Table</a></li><li><a href=/docs/v0-beta/config/mysql/>MySQL</a></li></ul></li><li><a href=/docs/v0-beta/metrics/>Metrics</a></li><li><input type=checkbox id=section-cf40158fdbef376e5228232dc90bf04d class=toggle checked>
<label for=section-cf40158fdbef376e5228232dc90bf04d class=flex><a role=button>Migration</a>
<img src=/docs/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/v0-beta/migration/overview/>Overview</a></li><li><a href=/docs/v0-beta/migration/safety/>Safety</a></li><li><a href=/docs/v0-beta/migration/part-1/>Part 1: Compatiblity</a></li><li><a href=/docs/v0-beta/migration/part-2/ class=active>Part 2: Backfill</a></li><li><a href=/docs/v0-beta/migration/part-3/>Part 3: Verify SQL</a></li><li><a href=/docs/v0-beta/migration/part-4/>Part 4: Cut Over</a></li></ul></li><li><a href=/docs/v0-beta/supported-requests/>Supported Requests</a></li></ul></li><li><a href=/docs/table-modes/>Table Modes</a></li><li><a href=/docs/lockout/>Lockout</a></li></ul><div style="margin:1em 0">~</div><div style=display:flex;flex-direction:column;gap:1em><a href="mailto:early@mlrd.tech?subject=Join%20private%20beta&body=Let%27s%20talk%20about%20mlrd." style=color:#ff8c42>Join Beta</a>
<a href=/>mlrd.tech</a></div></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/docs/icons/menu.svg class=book-icon alt=Menu></label><h3>Part 2: Backfill</h3><label for=toc-control></label></div></header><div class=beta-docs>Beta Preview Docs</div><article class="markdown book-article"><h1 id=part-2-backfill-and-dual-write-data>Part 2: Backfill and Dual-write Data</h1><p><img src=/img/mlrd_migration_phase_2.png alt="mlrd Migration Phase 2"></p><ol><li>Create empty backfill lock: <code>INSERT INTO mlrd._migration (tableName, flag) VALUES ('...', 'backfill')</code></li><li>Start <em>one</em> <code>mlrd</code> in a backfill mode</li><li>Dump DynamoDB table and load into MySQL but <em>do not</em> overwrite existing items because anything already present in MySQL is from a write</li></ol><ul><li>DynamoDB is written to <em>first</em> and remains authoritative (the source of truth)</li><li>MySQL is written to second (as shown in the <code>Write2</code> column above)</li><li>Backfill writes are authoritative</li></ul><blockquote class=book-hint><p>Items in MySQL are newest: either from a mirror write or a backfill
MySQL write error during backfill: OK, just be sure to log and retry/re-backfill the item(s)</p></blockquote></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/docs/v0-beta/migration/part-1/ class="flex align-center"><img src=/docs/icons/backward.svg class=book-icon alt=Backward>
<span>Part 1: Compatiblity</span>
</a></span><span><a href=/docs/v0-beta/migration/part-3/ class="flex align-center"><span>Part 3: Verify SQL</span>
<img src=/docs/icons/forward.svg class=book-icon alt=Forward></a></span></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>